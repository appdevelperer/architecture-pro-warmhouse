@startuml ToBe
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

title Диаграмма контекста (C4): Целевая экосистема "Тёплый дом" (To-Be)

Person(user, "Пользователь (владелец дома)", "Самостоятельно подключает устройства, создаёт сценарии, управляет домом через веб/мобильное приложение")

System(smartHomePlatform, "Экосистема умного дома (SaaS)", "Централизованная платформа для управления устройствами, сценариями и телеметрией. Асинхронная, микросервисная архитектура.")

System_Ext(partnerDevices, "Устройства партнёров", "Любые совместимые устройства: отопление, свет, ворота, камеры. Подключаются по стандартным протоколам (MQTT, Zigbee и др.)")
System_Ext(cloudServices, "Облачные сервисы интеграции", "Брокеры сообщений, шлюзы протоколов, API для партнёров")

System_Ext(mobileApp, "Мобильное приложение", "iOS/Android клиент для удалённого управления")
System_Ext(webPortal, "Веб-портал самообслуживания", "Регистрация, настройка, покупка модулей, управление сценариями")

Rel(user, webPortal, "Регистрируется, настраивает, покупает модули", "HTTPS")
Rel(user, mobileApp, "Управляет домом в реальном времени", "HTTPS / WebSocket")

Rel(webPortal, smartHomePlatform, "Передаёт конфигурации, сценарии", "API")
Rel(mobileApp, smartHomePlatform, "Отправляет команды, получает телеметрию", "API / WebSocket")

Rel(smartHomePlatform, cloudServices, "Интегрируется для обмена сообщениями с устройствами", "MQTT / HTTP / gRPC")
Rel(cloudServices, partnerDevices, "Маршрутизирует команды и данные", "MQTT / Zigbee / Proprietary")

' Показываем расширяемость
note right of smartHomePlatform
  Поддерживает подключение новых типов устройств
  и сценариев без изменения ядра системы.
  Архитектура: микросервисы + event-driven.
end note

LAYOUT_WITH_LEGEND()

@enduml